=== PHASE B: SECURITY & STATIC ANALYSIS ===

Step 1: Installing security tools...
time="2025-10-19T10:43:10+05:30" level=warning msg="C:\\Users\\srina\\OneDrive\\Documents\\Downloads\\Stealth-Reecovery-20251010T154256Z-1-001\\Stealth-Reecovery\\docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 24.0 -> 25.2
[notice] To update, run: pip install --upgrade pip

Step 2: Running bandit security scan...
time="2025-10-19T10:43:18+05:30" level=warning msg="C:\\Users\\srina\\OneDrive\\Documents\\Downloads\\Stealth-Reecovery-20251010T154256Z-1-001\\Stealth-Reecovery\\docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.11.14
Run started:2025-10-19 05:13:19.639866

Test results:
>> Issue: [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based query construction.
   Severity: Medium   Confidence: Medium
   CWE: CWE-89 (https://cwe.mitre.org/data/definitions/89.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b608_hardcoded_sql_expressions.html
   Location: app/tasks/partition_tasks.py:29:32
28	            # Check if partition exists
29	            result = db.execute(f"""
30	                SELECT 1 FROM pg_tables 
31	                WHERE tablename = '{partition_name}'
32	            """).fetchone()
33	            

--------------------------------------------------

Code scanned:
	Total lines of code: 3074
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 14
		Medium: 1
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 3
		High: 12
Files skipped (0):

Step 3: Checking npm vulnerabilities...
npm warn config production Use `--omit=dev` instead.
found 0 vulnerabilities

Step 4: Verifying authentication security...
  Checking JWT secret length...
  ✅ JWT secret configured
  Checking bcrypt usage...
  time="2025-10-19T10:43:27+05:30" level=warning msg="C:\\Users\\srina\\OneDrive\\Documents\\Downloads\\Stealth-Reecovery-20251010T154256Z-1-001\\Stealth-Reecovery\\docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
✅ bcrypt available

Step 5: Verifying .env security...
  ✅ .env in .gitignore

==========================================
     PHASE B: SECURITY ANALYSIS RESULTS
==========================================
Bandit Critical Issues: 0
0
NPM Critical Issues: 0
0
JWT Security: ✅ Configured
Password Hashing: ✅ bcrypt
.env Protection: ✅ gitignored

bash: [: 0
0: integer expression expected
⚠️  PHASE B PARTIAL - Review critical issues
==========================================
